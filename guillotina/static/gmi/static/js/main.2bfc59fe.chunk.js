(this["webpackJsonp@guillotinaweb/react-gmi"]=this["webpackJsonp@guillotinaweb/react-gmi"]||[]).push([[0],{19:function(e,t,a){e.exports=a(29)},28:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(14),c=a.n(s),l=a(2),i=a(1),o=a.n(i),u=a(3),m=a(5),d=a(6),p=function(){function e(t,a){Object(m.a)(this,e),this.auth=a,this.url=t}return Object(d.a)(e,[{key:"request",value:function(e,t,a){return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return(t=t||{}).headers=a||this.getHeaders(),n.next=4,o.a.awrap(fetch("".concat(this.url).concat(e),t));case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),null,this)}},{key:"getHeaders",value:function(){var e=this.auth.getToken();return!!e&&{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e}}},{key:"post",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.request(e,{method:"post",body:JSON.stringify(t)}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"get",value:function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(this.request(e,{}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,this)}},{key:"put",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.request(e,{method:"put",body:JSON.stringify(t)}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"patch",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.request(e,{method:"PATCH",body:JSON.stringify(t)}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"upload",value:function(e,t){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return delete(a=this.getHeaders())["Content-Type"],a["Content-Type"]=t["content-type"],a["X-UPLOAD-FILENAME"]=t.filename,a["Content-Encoding"]="base64",n.next=7,o.a.awrap(this.request(e,{method:"PATCH",body:t.data},a));case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),null,this)}},{key:"delete",value:function(e){var t,a=arguments;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:void 0,n.next=3,o.a.awrap(this.request(e,{method:"delete",body:JSON.stringify(t)}));case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),null,this)}}]),e}(),f=function(e){return e.filter(Boolean).join(" ").trim()},h=function(){},v=0,g=function(e){return"".concat(e||"id","-").concat(v++)},E=function(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")};function b(e){return new Promise((function(t,a){setTimeout((function(){t()}),e)}))}var y={},x={},N=function(){function e(t,a){Object(m.a)(this,e),this.rest=t,this.isContainer=a}return Object(d.a)(e,[{key:"getContext",value:function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="/"===t.t0?3:6;break;case 3:return t.next=5,o.a.awrap(this.rest.get(""));case 5:return t.abrupt("return",t.sent);case 6:return e.startsWith("/")&&(e=e.substring(1)),t.next=9,o.a.awrap(this.rest.get(e));case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),null,this)}},{key:"get",value:function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e.startsWith("/")&&(e=e.slice(1)),t.next=3,o.a.awrap(this.rest.get(e));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),null,this)}},{key:"getItems",value:function(e){var t,a,n,r,s=arguments;return o.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=s.length>1&&void 0!==s[1]?s[1]:0,a=s.length>2&&void 0!==s[2]?s[2]:10,e.startsWith("/")&&(e=e.slice(1)),c.next=5,o.a.awrap(this.rest.get("".concat(e,"@search?depth=1&b_start=").concat(t,"&b_size=").concat(a)));case 5:return n=c.sent,c.next=8,o.a.awrap(n.json());case 8:return r=c.sent,c.abrupt("return",this.applyCompat(r));case 10:case"end":return c.stop()}}),null,this)}},{key:"applyCompat",value:function(e){return e.member=e.items,e.items_count=e.items_total,e}},{key:"search",value:function(e,t){var a,n,r,s,c,l,i,u,m=arguments;return o.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return a=m.length>2&&void 0!==m[2]&&m[2],n=!(m.length>3&&void 0!==m[3])||m[3],r=m.length>4&&void 0!==m[4]?m[4]:0,s=m.length>5&&void 0!==m[5]?m[5]:10,e.startsWith("/")&&(e=e.slice(1)),a&&(e=w(e)),c=n?E(t):t,l="".concat(e,"@search?").concat(c,"&b_start=").concat(r,"&b_size=").concat(s),d.next=10,o.a.awrap(this.rest.get(l));case 10:return i=d.sent,d.next=13,o.a.awrap(i.json());case 13:return u=d.sent,d.abrupt("return",this.applyCompat(u));case 15:case"end":return d.stop()}}),null,this)}},{key:"canido",value:function(e,t){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.startsWith("/")&&(e=e.slice(1)),Array.isArray(t)&&t.join(","),a="".concat(e,"@canido?permissions=").concat(t),n.next=5,o.a.awrap(this.rest.get(a));case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),null,this)}},{key:"createObject",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.rest.post(e,t));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"cleanPath",value:function(e){return e.replace(this.rest.url,"")}},{key:"delete",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.rest.delete(this.cleanPath(e),t));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"create",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e.startsWith("/")&&(e=e.substring(1)),a.next=3,o.a.awrap(this.rest.post(e,t));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),null,this)}},{key:"post",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.create(e,t));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"patch",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e.startsWith("/")&&(e=e.substring(1)),a.next=3,o.a.awrap(this.rest.patch(e,t));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),null,this)}},{key:"upload",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e.startsWith("/")&&(e=e.substring(1)),a.next=3,o.a.awrap(this.rest.upload(e,t));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),null,this)}},{key:"download",value:function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e.startsWith("/")&&(e=e.substring(1)),t.next=3,o.a.awrap(this.rest.get(e));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),null,this)}},{key:"getTypeSchema",value:function(e,t){var a,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(x[t]){r.next=8;break}return a=w(e),r.next=4,o.a.awrap(this.rest.get("".concat(a,"@types/").concat(t)));case 4:return n=r.sent,r.next=7,o.a.awrap(n.json());case 7:x[t]=r.sent;case 8:return r.abrupt("return",x[t]);case 9:case"end":return r.stop()}}),null,this)}},{key:"getAddons",value:function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(this.rest.get("".concat(e,"@addons")));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,this)}},{key:"installAddon",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.rest.post("".concat(e,"@addons"),{id:t}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"removeAddon",value:function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(this.rest.delete("".concat(e,"@addons"),{id:t}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),null,this)}},{key:"getGroups",value:function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t="".concat(w(e),"@groups"),a.next=3,o.a.awrap(this.rest.get(t));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),null,this)}},{key:"getUsers",value:function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t="".concat(w(e),"@users"),a.next=3,o.a.awrap(this.rest.get(t));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),null,this)}},{key:"getPrincipals",value:function(e){var t,a,n,r,s,c;return o.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=this.getGroups(e),a=this.getUsers(e),i.next=4,o.a.awrap(Promise.all(t,a));case 4:return n=i.sent,r=Object(l.a)(n,2),s=r[0],c=r[1],i.next=10,o.a.awrap(s.json());case 10:return i.t0=i.sent,i.next=13,o.a.awrap(c.json());case 13:return i.t1=i.sent,i.abrupt("return",{groups:i.t0,users:i.t1});case 15:case"end":return i.stop()}}),null,this)}},{key:"getRoles",value:function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t="".concat(w(e),"@available-roles"),a.next=3,o.a.awrap(this.rest.get(t));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),null,this)}},{key:"getAllPermissions",value:function(e){var t,a,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e.endsWith("/")||(e="".concat(e,"/")),r.next=3,o.a.awrap(this.rest.get(e+"@all_permissions"));case 3:return t=r.sent,r.next=6,o.a.awrap(t.json());case 6:return a=r.sent,n=Array.from(new Set(j(a))),r.abrupt("return",n);case 9:case"end":return r.stop()}}),null,this)}},{key:"getTypes",value:function(e){var t,a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.startsWith("/")&&(e=e.slice(1)),y[e]){n.next=13;break}return n.next=4,o.a.awrap(this.rest.get(e+"@addable-types"));case 4:if(401!==(t=n.sent).status&&404!==t.status){n.next=9;break}y[e]=[],n.next=13;break;case 9:return n.next=11,o.a.awrap(t.json());case 11:a=n.sent,y[e]=a;case 13:return n.abrupt("return",y[e]);case 14:case"end":return n.stop()}}),null,this)}}]),e}();var w=function(e){e.startsWith("/")&&(e=e.substring(1));var t=e.split("/");return"".concat(t[0],"/").concat(t[1],"/")},O=function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var a=new FileReader;a.readAsArrayBuffer(e),a.onloadend=function(a){var n=a.target.result;t({filename:e.name,data:n,"content-type":e.type})}})));case 1:case"end":return t.stop()}}))},j=function e(t){var a=[];return"object"!==typeof t||(!Array.isArray(t)&&t.permission?a=a.concat([t.permission]):Array.isArray(t)?Array.isArray(t)&&t.map((function(t){return a=a.concat(e(t))})):Object.keys(t).map((function(n){return a=a.concat(e(t[n]))}))),a},k=(Object(n.createContext)({}),Object(n.createContext)({})),C=function(){function e(t){Object(m.a)(this,e),Object.assign(this,t)}return Object(d.a)(e,[{key:"setPath",value:function(e){this.setRouterParam({path:e},!0)}},{key:"refresh",value:function(){this.dispatch({type:"REFRESH"})}},{key:"apply",value:function(e){this.dispatch({type:"APPLY",payload:e})}},{key:"flash",value:function(e,t){this.dispatch({type:"SET_FLASH",payload:{flash:{message:e,type:t}}})}},{key:"clearFlash",value:function(){this.dispatch({type:"CLEAR_FLASH"})}},{key:"doAction",value:function(e,t){this.dispatch({type:"SET_ACTION",payload:{action:e,params:t}})}},{key:"cancelAction",value:function(){this.dispatch({type:"CLEAR_ACTION"})}},{key:"hasPerm",value:function(e){return!0===this.state.permissions[e]}},{key:"filterTabs",value:function(e,t){var a=this,n={};return Object.keys(e).forEach((function(r){var s=t[r];s&&a.hasPerm(s)?n[r]=e[r]:s||(n[r]=e[r])})),n}},{key:"path",get:function(){return this.state.path}},{key:"pathPrefix",get:function(){return this.state.path.slice(1)}},{key:"context",get:function(){return this.state.context}},{key:"containerPath",get:function(){return w(this.path)}}]),e}();function S(e){var t=e.children,a=Object(u.a)(e,["children"]);return r.a.createElement(k.Provider,{value:new C(a)},t)}var A=a(16),P=a.n(A),R=a(9),_=function(){},z=function(e){var t,a=e.children,n=e.className,s=void 0===n?"is-primary":n,c=e.onClick,l=e.type,i=void 0===l?"submit":l,o=e.loading,m=void 0!==o&&o,d=e.disabled,p=void 0!==d&&d,h=Object(u.a)(e,["children","className","onClick","type","loading","disabled"]),v=(t=[]).concat.apply(t,["button"].concat(Object(R.a)(s.split(" "))));return m&&(v=v.concat("is-loading")),p&&(c=_),r.a.createElement("p",{className:"control"},r.a.createElement("button",Object.assign({type:i,className:f(v),onClick:c,disabled:p},h),a))};function T(e){var t=e.isActive,a=e.setActive,n=e.children,s=P()().Portal,c="modal "+(t?"is-active ":"")+e.className;return r.a.createElement(s,null,r.a.createElement("div",{className:c},r.a.createElement("div",{className:"modal-background",onClick:function(){return a(!1)}}),r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"box"},n)),r.a.createElement("button",{className:"modal-close is-large","aria-label":"close",onClick:function(){return a(!1)}})))}function I(e){var t=e.message,a=e.onCancel,n=e.onConfirm,s=e.loading;return r.a.createElement(T,{isActive:!0,setActive:function(e){return a()},className:"confirm"},r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"title is-size-5"},t||"Are you Sure?"),r.a.createElement("div",{className:"level",style:{marginTop:50}},r.a.createElement("div",{className:"level-left"}),r.a.createElement("div",{className:"level-right"},r.a.createElement("button",{className:"button is-danger",onClick:function(){return a()}},"Cancel"),"\xa0\xa0",r.a.createElement(z,{loading:s,className:"is-success",onClick:function(){return n()}},"Confirm")))))}function D(e){var t=e.title,a=e.onConfirm,n=e.onCancel;return r.a.createElement(T,{isActive:!0,setActive:n},r.a.createElement("h1",null,t),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a(e.target[0].value)}},r.a.createElement("input",{className:"input",placeholder:"/folder (without /db/container on front)",style:{margin:"20px 0"},type:"text"}),r.a.createElement("div",{className:"level-right"},r.a.createElement("button",{type:"button",className:"button is-danger",onClick:n},"Cancel"),"\xa0\xa0",r.a.createElement("button",{type:"submit",className:"button is-success"},"Confirm"))))}var F={DisabledTypes:["UserManager","GroupManager"],PageSize:10,DelayActions:200},U=Object.assign({},F),M=function(e,t){var a=Object.assign({},t);return Object.keys(e).forEach((function(t){"object"===typeof F[t]&&Array.isArray(F[t])?a[t]=[].concat(F[t],e[t]):a[t]="object"===typeof F[t]?Object.assign({},F[t],e[t]):e[t]})),a};function L(e){var t=r.a.useRef();return e&&!t.current&&(console.log("cfg",e),U=M(e,U),t.current=U),U}var B=function(e){return e["@id"]?e["@id"]:e["@absolute_url"]};var q=function(e){var t=e.id,a=e.className,s=e.loading,c=e.disabled,i=e.indeterminate,o=void 0!==i&&i,m=e.value,d=void 0!==m&&m,p=(e.color,e.backgroundColor,e.borderColor,e.children),h=e.placeholder,v=e.onChange,g=Object(u.a)(e,["id","className","loading","disabled","indeterminate","value","color","backgroundColor","borderColor","children","placeholder","onChange"]),E=Object(n.useRef)(null),b=r.a.useState(d),y=Object(l.a)(b,2),x=y[0],N=y[1];Object(n.useEffect)((function(){E.current&&(E.current.indeterminate=o)}),[o]);return r.a.createElement("div",{className:"field"},r.a.createElement("label",{htmlFor:t,className:f(["checkbox",a])},r.a.createElement("input",Object.assign({ref:E,disabled:c||s,id:t,type:"checkbox",className:"checkbox",checked:x,onChange:function(e){N(e.target.checked),v(e.target.checked)}},g)),p||h))},W=function(e){var t=e.children,a=e.id,n=e.className;return r.a.createElement("p",{className:f(["help is-danger",n]),id:a},t)},G=function(e,t,a){var n=r.a.useState({hasError:!1,value:t}),s=Object(l.a)(n,2),c=s[0],i=s[1];return r.a.useEffect((function(){i({value:t,hasError:!1})}),[t]),{onChange:function(t){var a=t&&t.target?t.target.value:t||"";i({value:a,hasError:!1}),e&&e(a)},onFocus:function(e){c.hasError&&i({value:c.value,hasError:!1})},onBlur:function(e){var t=!1===function(e,t){var a=Array.isArray(t)?t:[t],n=!0;return a.forEach((function(t){!1===t(e)&&(n=!1)})),n}(c.value,a);t&&i({value:c.value,hasError:t})},state:c}},H=/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/i,J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return H.test(e)},V=function(e){return!!e.length},Y=function(){return!0},Z=r.a.forwardRef((function(e,t){var a=e.icon,s=e.iconPosition,c=void 0===s?"has-icons-right":s,i=e.error,o=e.errorZoneClassName,m=e.autoComplete,d=void 0===m?"off":m,p=e.className,h=void 0===p?"":p,v=e.widget,E=void 0===v?"input":v,b=e.type,y=void 0===b?"text":b,x=(e.onPressEnter,e.isSubmitted,e.loading),N=void 0!==x&&x,w=e.required,O=void 0!==w&&w,j=e.id,k=e.placeholder,C=e.value,S=e.autofocus,A=void 0!==S&&S,P=e.onChange,R=e.validator,_=void 0===R?Y:R,z=e.errorMessage,T=Object(u.a)(e,["icon","iconPosition","error","errorZoneClassName","autoComplete","className","widget","type","onPressEnter","isSubmitted","loading","required","id","placeholder","value","autofocus","onChange","validator","errorMessage"]);O&&(_=Array.isArray(_)?_.push(V):[_,V]);var I=G(P,C,_),D=I.state,F=Object(u.a)(I,["state"]),U=Object(n.useState)(g("input")),M=Object(l.a)(U,1)[0],L=Object(n.useState)(!1),B=Object(l.a)(L,2),q=B[0],H=B[1];t=t||r.a.useRef(),Object(n.useEffect)((function(){H(!0)}),[]),Object(n.useEffect)((function(){A&&!i&&t.current.focus()}),[q,A,t,i]);var J=D.hasError?z||"invalid field":"",Z=D.hasError?"is-danger":"";return r.a.createElement("div",{className:"field"},j&&k?r.a.createElement("label",{className:"label",htmlFor:j},k):null,r.a.createElement("div",{className:f(a?["control",c]:["control"])},r.a.createElement("input",Object.assign({className:f([E,h,Z]),"aria-invalid":J,"aria-describedby":M,id:j,ref:t,type:y,value:D.value,placeholder:k,autoComplete:d,disabled:N||T.disabled,required:O},F,T)),a&&a),r.a.createElement(W,{className:o,id:M},D.hasError?J:""))})),$=function(e){var t=e.icon,a=e.className,n=e.align,s=a?a.split(" "):[a];return n=n||"is-right",r.a.createElement("span",{className:f(["icon",n].concat(Object(R.a)(s)))},r.a.createElement("i",{className:t}))},X=function(e){var t=e.children,a=e.className,n=void 0===a?"":a,s=e.onSubmit,c=void 0===s?h:s,l=e.onReset,i=void 0===l?h:l,o=e.autoComplete,m=void 0===o?"off":o,d=e.title,p=e.error,v=Object(u.a)(e,["children","className","onSubmit","onReset","autoComplete","title","error"]);return r.a.createElement(r.a.Fragment,null,d&&r.a.createElement("div",{className:"level"},r.a.createElement("h1",{className:"title is-size-4"},d)),p&&r.a.createElement("div",{className:"notification is-danger"},p),r.a.createElement("form",Object.assign({onSubmit:function(e){e.preventDefault(),c(e)},onReset:i,autoComplete:m,className:f(["form",n])},v),t))},K={string:Z,password:function(e){var t=e.value,a=void 0===t?"":t,n=Object(u.a)(e,["value"]);return r.a.createElement(Z,Object.assign({value:a,type:"password"},n))},boolean:q,email:function(e){var t=e.value,a=void 0===t?"":t,n=Object(u.a)(e,["value"]);return r.a.createElement(Z,Object.assign({type:"email",validator:J,errorMessage:"Email address invalid",value:a,icon:r.a.createElement($,{icon:"fas fa-envelope"})},n))}};function Q(e){var t=e.schema,a=e.formData,n=(e.title,e.onSubmit),s=e.actionName,c=e.children,l=e.exclude,i=void 0===l?[]:l,o=e.remotes,m=void 0===o?[]:o,d=e.submitButton,p=void 0===d||d,f=Object(u.a)(e,["schema","formData","title","onSubmit","actionName","children","exclude","remotes","submitButton"]),h=r.a.useRef(),v=t.properties,E=t.required,b=Object.assign({},a||{}),y={},x=Object.keys(v).filter((function(e){return!i.includes(e)}));x.forEach((function(e){y[e]=b[e]||void 0})),h.current?Object.keys(m).forEach((function(e){JSON.stringify(h.current[e])!==JSON.stringify(m[e])&&(h.current[e]=m[e])})):(h.current={},Object.keys(m).forEach((function(e){return h.current[e]=m[e]}))),h.current=h.current||{};var N=function(e){return function(t){h.current[e]=t.target?t.target.value:t.value||t}},w=function(e){var t=e.field,a=K[v[t].widget||v[t].type],n={label:v[t].title,value:y[t],onChange:N(t),placeholder:v[t].title||"",id:g()};return E.includes(t)&&(n.required=!0,n.placeholder+=" *"),a.displayName="".concat(t,"Field"),r.a.createElement(a,n)},O=r.a.Children.map(c,(function(e){return r.a.cloneElement(e,{onChange:N})}));return r.a.createElement(X,Object.assign({onSubmit:function(){n(h.current,b)}},f),x.map((function(e,t){return r.a.createElement(w,{field:e,key:e})})),O,p&&r.a.createElement(z,null,s))}var ee=function(e){var t=e.options,a=(e.error,e.size),n=void 0===a?1:a,s=e.className,c=void 0===s?"":s,l=e.classWrap,i=void 0===l?"":l,o=e.multiple,m=void 0!==o&&o,d=e.loading,p=void 0!==d&&d,h=(e.isSubmitted,e.onChange),v=e.resetOnChange,g=e.appendDefault,E=void 0!==g&&g,b=e.style,y=void 0===b?{}:b,x=Object(u.a)(e,["options","error","size","className","classWrap","multiple","loading","isSubmitted","onChange","resetOnChange","appendDefault","style"]),N=r.a.useRef();E&&(t=[{text:"Choose..",value:""}].concat(t));var w=["select",m?"is-multiple":"",i];return r.a.createElement("div",{className:f(w)},r.a.createElement("select",Object.assign({className:f(["",c]),size:n,multiple:m,disabled:p||x.disabled,onChange:function(e){""===e.target.value?h({target:{value:void 0}}):h(e),v&&(N.current.value="")}},x,{ref:N,style:y}),t.map((function(e,t){var a=e.text,n=Object(u.a)(e,["text"]);return r.a.createElement("option",Object.assign({key:t.toString()},n),a)}))))};function te(e){var t=e.label,a=e.onChange,n=Object(u.a)(e,["label","onChange"]);return r.a.createElement("div",{className:"file"},r.a.createElement("label",{className:"file-label"},r.a.createElement("input",Object.assign({className:"file-input"},n,{type:"file",name:"file",onChange:function(e){var t;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(O(e.target.files[0]));case 2:t=n.sent,a(t);case 4:case"end":return n.stop()}}))}})),r.a.createElement("span",{className:"file-cta"},r.a.createElement("span",{className:"file-icon"},r.a.createElement("i",{className:"fas fa-upload"})),r.a.createElement("span",{className:"file-label"},t||"Choose a file\u2026"))))}var ae=r.a.forwardRef((function(e,t){var a=e.value,n=void 0===a?"":a,s=e.rows,c=void 0===s?5:s,l=e.className,i=e.onChange,o=Object(u.a)(e,["value","rows","className","onChange"]),m="textarea "+l;return r.a.createElement("div",{className:"field"},r.a.createElement("textarea",Object.assign({className:m,rows:c,onChange:function(e){i&&i(e.target.value)},value:n},o,{ref:t})))})),ne=a(7),re=a(4),se=a(30),ce={loading:void 0,isError:!1,errorMessage:void 0,result:void 0,response:void 0},le=function(e){var t,a=arguments;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=!(a.length>1&&void 0!==a[1])||a[1],!(e.status<400)){n.next=14;break}if(!t){n.next=8;break}return n.next=5,o.a.awrap(e.json());case 5:n.t0=n.sent,n.next=9;break;case 8:n.t0=e.status;case 9:return n.t1=n.t0,n.t2=e,n.abrupt("return",{isError:!1,loading:!1,result:n.t1,response:n.t2});case 14:return n.abrupt("return",{isError:!0,loading:!1,errorMessage:e.status,response:e});case 15:case"end":return n.stop()}}))},ie=function(e,t,a){return function(e,n){var r,s,c,l,i=arguments;return o.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],t({loading:!0}),s={},u.prev=3,c=n?"".concat(a.path).concat(n):a.path,u.next=7,o.a.awrap(a.client.patch(c,e));case 7:return l=u.sent,u.next=10,o.a.awrap(le(l,r));case 10:s=u.sent,u.next=17;break;case 13:u.prev=13,u.t0=u.catch(3),console.error("Error",u.t0),s={isError:!0,errorMessage:"unhandled exception"};case 17:return t(s),u.abrupt("return",s);case 19:case"end":return u.stop()}}),null,null,[[3,13]])}},oe=function(e,t,a){return function(e,n){var r,s,c,l,i=arguments;return o.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],t({loading:!0}),s={},u.prev=3,c=n?"".concat(a.path).concat(n):a.path,u.next=7,o.a.awrap(a.client.delete(c,e));case 7:return l=u.sent,u.next=10,o.a.awrap(le(l,r));case 10:s=u.sent,u.next=17;break;case 13:u.prev=13,u.t0=u.catch(3),console.error("Error",u.t0),s={isError:!0,errorMessage:"unhandled exception"};case 17:return t(s),u.abrupt("return",s);case 19:case"end":return u.stop()}}),null,null,[[3,13]])}},ue=function(e,t,a){return function(e,n){var r,s,c,l,i=arguments;return o.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r=!(i.length>2&&void 0!==i[2])||i[2],t({loading:!0}),s={},u.prev=3,c=n?"".concat(a.path).concat(n):a.path,u.next=7,o.a.awrap(a.client.post(c,e));case 7:return l=u.sent,u.next=10,o.a.awrap(le(l,r));case 10:s=u.sent,u.next=17;break;case 13:u.prev=13,u.t0=u.catch(3),console.error("Error",u.t0),s={isError:!0,errorMessage:"unhandled exception"};case 17:return t(s),u.abrupt("return",s);case 19:case"end":return u.stop()}}),null,null,[[3,13]])}},me=function(e,t,a){return function(e){var n,r,s;return o.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t({loading:!0}),n=e?"".concat(a.path).concat(e):a.path,c.next=4,o.a.awrap(a.client.get(n));case 4:return r=c.sent,c.next=7,o.a.awrap(r.json());case 7:return s=c.sent,t({loading:!1,result:s,response:r}),c.abrupt("return",s);case 10:case"end":return c.stop()}}))}};function de(){var e=r.a.useContext(k),t=Object(se.a)(ce),a=Object(l.a)(t,2),n=a[0],s=a[1];return Object(re.a)({},n,{Ctx:e,patch:ie(n,s,e),del:oe(n,s,e),post:ue(n,s,e),get:me(n,s,e)})}var pe=a(17),fe=function(e){var t=Object(pe.a)({},e);return r.a.createElement("div",Object.assign({className:"progress-line"},t))},he=function(e){var t=e.name,a=e.onRemove,n=e.size,s=void 0===n?"is-medium":n,c=e.color,l=void 0===c?"is-warning":c;return r.a.createElement("span",{className:f(["tag",l,s])},t,void 0!==a&&r.a.createElement("button",{className:"delete is-small",onClick:function(){return a()}}))};function ve(e){var t=e.onClick,a=e.children;return r.a.createElement("button",{type:"button",onClick:t,className:"delete"},a)}function ge(e){var t=e.headers,a=e.children,n=e.className;return n=n?n.split(" "):" is-full is-fullwidth is-narrow".split(" "),r.a.createElement("table",{className:f(["table"].concat(Object(R.a)(n)))},r.a.createElement("thead",null,r.a.createElement("tr",null,t&&t.map((function(e,t){return r.a.createElement("th",{key:e+t},e)})))),r.a.createElement("tbody",null,a))}function Ee(e){var t=e.isColor,a=void 0===t?"":t,n=e.children;return r.a.createElement("div",{className:"notification is-"+a},n)}function be(e){var t=e.field,a=e.value,s=e.Type,c=void 0===s?Z:s,i=e.ns,u=Object(n.useRef)(),m=Object(n.useState)(!1),d=Object(l.a)(m,2),p=d[0],f=d[1],h=de(),v=h.patch,g=h.loading,E=h.Ctx,b=Object(n.useState)(a),y=Object(l.a)(b,2),x=y[0],N=y[1],w=function(e){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e&&e.preventDefault(),a=i?Object(ne.a)({},i,Object(ne.a)({},t,x)):Object(ne.a)({},t,x),n.next=4,o.a.awrap(v(a));case 4:E.flash("Field ".concat(t,", updated!"),"success"),E.refresh(),f(!1);case 7:case"end":return n.stop()}}))};return Object(n.useEffect)((function(){p&&u.current&&u.current.focus()})),r.a.createElement(r.a.Fragment,null,!p&&r.a.createElement("div",{className:"editable",onClick:function(){return f(!0)}},a||"Click to edit",r.a.createElement($,{icon:"fas fa-edit"})),p&&r.a.createElement("div",{className:"field"},r.a.createElement("form",{onSubmit:w},r.a.createElement("div",{className:"control"},r.a.createElement(c,{value:x||"",className:"is-small",onChange:function(e){return N(e)},ref:u})),r.a.createElement("div",{className:"field is-grouped"},r.a.createElement("div",{className:"control"},r.a.createElement(z,{className:"is-small is-primary",loading:g,onClick:w},"Save")),r.a.createElement("div",{className:"control"},r.a.createElement(z,{className:"is-small",onClick:function(){return f(!1)}},"Cancel"))))))}var ye=["string","number","boolean"];function xe(e){var t=e.value,a=e.Widget;if(!t)return"";if(a)return r.a.createElement(a,{value:t});var n=typeof t;return ye.includes(n)?t:"object"===n?Array.isArray(t)?t.map((function(e){return r.a.createElement("div",{key:e},r.a.createElement(xe,{value:e}))})):Object.keys(t).map((function(e){return r.a.createElement(Ne,{field:e,value:t[e],key:e})})):r.a.createElement("p",null,"No render for ",JSON.stringify(t))}var Ne=function(e){var t=e.field,a=e.value;return r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"label"},t),r.a.createElement("div",{className:"value"},r.a.createElement(xe,{value:a})))};var we={editable:["title","description","effective_date","expiration_date"],widgets:{description:ae}};var Oe=a(31);var je=function(e){var t=ke(e.available);return{available:e.available.filter((function(t){return!e.installed.includes(t.id)})),installed:e.installed.map((function(e){return t[e]}))}},ke=function(e){return e.reduce((function(e,t){return e[t.id]=t,e}),{})};function Ce(){var e=de(),t=e.Ctx,a=e.get,n=e.result,s=e.loading,c=e.isError,i=de(),u=r.a.useState(!1),m=Object(l.a)(u,2),d=m[0],p=m[1],f=function(e){return function(){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(i.patch({behavior:e},"@behaviors"));case 2:p(!d),t.refresh();case 4:case"end":return a.stop()}}))}},h=function(e){return function(){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(i.del({behavior:e},"@behaviors"));case 2:p(!d),t.refresh();case 4:case"end":return a.stop()}}))}};return r.a.useEffect((function(){o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(a("@behaviors"));case 2:case"end":return e.stop()}}))}),[d]),r.a.createElement("div",{className:"columns behaviors"},r.a.createElement("div",{className:"column is-8 is-size-7"},r.a.createElement("h2",{className:"title is-size-5 has-text-grey-dark"},"Behaviors"),!s&&!c&&n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ge,null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("h3",{className:"title is-size-6"},"Static"))),n.static.map((function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,"Static"),r.a.createElement("td",null,e),r.a.createElement("td",{className:""},r.a.createElement(z,{className:"is-small is-pulled-right",disabled:!0},"Disable")))}))),r.a.createElement(ge,null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("h3",{className:"title is-size-6"},"Enabled"))),n.dynamic.map((function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,"Enabled"),r.a.createElement("td",null,e),r.a.createElement("td",null,r.a.createElement(z,{className:"is-small is-danger is-pulled-right",onClick:h(e)},"Disable")))}))),r.a.createElement(ge,null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("h3",{className:"title is-size-6"},"Available"))),n.available.map((function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,"Available"),r.a.createElement("td",null,e),r.a.createElement("td",null,r.a.createElement(z,{className:"is-small is-primary is-pulled-right",onClick:f(e)},"Enable")))}))))),r.a.createElement("div",{className:"column is-4"}))}var Se=function(e){var t=new Date(e),a=t.getMinutes()<10?"0".concat(t.getMinutes()):t.getMinutes();return"".concat(t.getDate(),"/").concat(t.getMonth()+1,"/").concat(t.getFullYear()," ").concat(t.getHours(),":").concat(a)},Ae={local:{roleperm:{},prinperm:{},prinrole:{}},inherit:{}},Pe=function(){function e(t){Object(m.a)(this,e),Object.assign(this,t||Ae)}return Object(d.a)(e,[{key:"getRole",value:function(e){return this.local.roleperm[e]}},{key:"getPrincipals",value:function(e){return this.local.prinperm[e]}},{key:"getPrinroles",value:function(e){return this.local.prinrole[e]}},{key:"roles",get:function(){return Object.keys(this.local.roleperm)}},{key:"principals",get:function(){return Object.keys(this.local.prinperm)}},{key:"prinrole",get:function(){return Object.keys(this.local.prinrole)}}]),e}(),Re=function(){function e(t,a,n){Object(m.a)(this,e),this.item=t,this.url=a,this._path=n}return Object(d.a)(e,[{key:"path",get:function(){var e=(this.item["@id"]?this.item["@id"]:this.item["@absolute_url"]).split("//")[1].split("/").splice(1).join("/");return e="/".concat(e,"/"),this.url.length>0&&(e=this.url.startsWith("/")?e.replace(this.url.substring(1),""):e.replace(this.url,"")),e}},{key:"name",get:function(){return this.item.title||this.item["@name"]}},{key:"icon",get:function(){var e=L();if(e.icons&&e.icons[this.type])return e.icons[this.type];switch(this.type){case"GroupManager":return"fas fa-users-cog";case"UserManager":return"fas fa-user-cog";case"User":return"fas fa-user";case"Group":return"fas fa-users";case"Folder":return"fas fa-folder";default:return"fas fa-file"}}},{key:"fullPath",get:function(){return this._url+this.item.id}},{key:"id",get:function(){if(this.item.id)return this.item.id;var e=this.item["@id"].split("&")[0].split("/");return e[e.length-1]}},{key:"uid",get:function(){return this.item["@uid"]}},{key:"type",get:function(){return this.item["@type"]||this.item.type_name}},{key:"title",get:function(){return this.item.title}},{key:"created",get:function(){return this.item.creation_date?Se(this.item.creation_date):""}},{key:"updated",get:function(){return this.item.modification_date?Se(this.item.modification_date):""}}]),e}(),_e=["guillotina.AddContent","guillotina.ModifyContent","guillotina.ViewContent","guillotina.DeleteContent","guillotina.AccessContent","guillotina.SeePermissions","guillotina.ChangePermissions","guillotina.MoveContent","guillotina.DuplicateContent","guillotina.ReadConfiguration","guillotina.RegisterConfigurations","guillotina.WriteConfiguration","guillotina.ManageAddons","guillotina.swagger.View"],ze=a(32);function Te(e){var t=e.children,a=e.disabled,s=e.id,c=e.isRight,i=e.onChange,o=e.optionDisabledWhen,m=e.options,d=Object(u.a)(e,["children","disabled","id","isRight","onChange","optionDisabledWhen","options"]),p=Object(n.useRef)(null),f=Object(n.useState)(!1),h=Object(l.a)(f,2),v=h[0],g=h[1],E=c?"is-right":"",b=v?"dropdown ".concat(E," is-active"):"dropdown ".concat(E);return Object(ze.a)(p,(function(){g(!1)})),r.a.createElement("div",Object.assign({ref:p,className:b},d),r.a.createElement("div",{className:"dropdown-trigger"},r.a.createElement("button",{className:"button is-size-7",onClick:function(){return g(!v)},"aria-haspopup":"true",disabled:a,"aria-controls":s},t)),r.a.createElement("div",{className:"dropdown-menu",id:s,role:"menu"},r.a.createElement("div",{className:"dropdown-content"},m.map((function(e){var t="function"===typeof o&&o(e);return(r.a.createElement("a",{className:t?"dropdown-item is-active":"dropdown-item",key:e.text,onClick:t?void 0:function(){return i(e.value)},style:t?{cursor:"not-allowed",color:"black",opacity:.5,backgroundColor:"#eeeeee"}:{}},e.text))})))))}var Ie=Object(n.createContext)({}),De={DELETE:{text:"Delete",perms:["guillotina.DeleteContent"],action:"removeItems"},MOVE:{text:"Move to...",perms:["guillotina.MoveContent"],action:"moveItems"},COPY:{text:"Copy to...",perms:["guillotina.DuplicateContent"],action:"copyItems"}};function Fe(e){var t=e.items,a=e.children,s=Object(n.useContext)(k),c=Object(n.useState)({}),i=Object(l.a)(c,2),o=i[0],u=i[1];return r.a.createElement(Ie.Provider,{value:{onAction:function(e){s.doAction(De[e].action,{items:t.filter((function(e){return o["".concat(e.path,"/").concat(e.id)]}))})},onSelectAllItems:function(e){u(t.reduce((function(t,a){return t["".concat(a.path,"/").concat(a.id)]=e,t}),{all:e}))},onSelectOneItem:function(e){u((function(t){return Object(re.a)({},t,Object(ne.a)({all:!1},"".concat(e.path,"/").concat(e.id),!t["".concat(e.path,"/").concat(e.id)]))}))},selected:o}},a)}function Ue(){var e=Object(n.useContext)(Ie),t=e.onSelectAllItems,a=e.selected;return r.a.createElement(q,{key:a.all,onChange:t,style:{marginLeft:2},value:a.all})}function Me(e){var t=e.item,a=Object(n.useContext)(Ie),s=a.selected,c=a.onSelectOneItem,l=s["".concat(t.path,"/").concat(t.id)];return r.a.createElement(q,{key:l,onChange:function(){return c(t)},value:l})}function Le(){var e=Object(n.useContext)(k),t=Object(n.useContext)(Ie),a=t.selected,s=t.onAction,c=Object.values(a).every((function(e){return!e})),l=Object.keys(De).map((function(e){return{text:De[e].text,value:e}}));return r.a.createElement(Te,{disabled:c,id:"items-actions",onChange:s,optionDisabledWhen:function(t){return De[t.value].perms.some((function(t){return!e.hasPerm(t)}))},options:l},"Choose action...")}function Be(e){var t=e.item,a=(e.setPath,e.icon),s=Object(n.useContext)(k),c=function(){return s.setPath(t.path)};return r.a.createElement("tr",null,r.a.createElement("td",{onClick:c,style:{width:"25px"}},a&&r.a.createElement($,{icon:a})),r.a.createElement("td",{onClick:c},t.id))}var qe={width:"25px"},We={width:"120px"};function Ge(e){var t=e.item,a=e.search,s=Object(n.useContext)(k),c=new Re(t,s.url,s.path),l=function(){return s.setPath(c.path)};return r.a.createElement("tr",{key:t},r.a.createElement("td",{style:qe},r.a.createElement(Me,{item:t})),r.a.createElement("td",{style:qe},r.a.createElement($,{icon:c.icon})),r.a.createElement("td",{style:qe,onClick:l},r.a.createElement("span",{className:"tag"},c.type)),r.a.createElement("td",{onClick:l},c.name,a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("span",{className:"is-size-7 tag is-light"},c.path))),r.a.createElement("td",{style:We,className:"is-size-7 is-vcentered"},c.created),r.a.createElement("td",{style:We,className:"is-size-7 is-vcentered"},c.updated),r.a.createElement("td",{style:qe},s.hasPerm("guillotina.DeleteContent")&&r.a.createElement(ve,{onClick:function(){return s.doAction("removeItems",{items:[c.item]})}})))}function He(e){var t=e.title,a=e.actions;return r.a.createElement("nav",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item"},r.a.createElement("h4",{className:"title has-text-primary is-size-5"},t))),r.a.createElement("div",{className:"level-right"},r.a.createElement("div",{className:"level-item"},a&&a)))}function Je(e){var t=e.current,a=e.total,n=e.doPaginate,s=e.pager,c=Math.ceil(a/s);return c<=1?null:r.a.createElement("div",null,r.a.createElement("p",{className:"level-right has-text-grey is-size-7"},r.a.createElement("span",{className:"has-text-black"},t+1),"/",r.a.createElement("span",{className:"has-text-black"},c),"\xa0of ",a," items"),r.a.createElement("nav",{className:"pagination is-size-7",role:"navigation","aria-label":"pagination"},r.a.createElement("a",{className:"pagination-previous is-small",disabled:0===t,onClick:function(){return t>0?n(t-1):null}},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-arrow-left"}))),r.a.createElement("a",{className:"pagination-next is-small",disabled:t>=c,onClick:function(){return n(t+1)}},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-arrow-right"})))))}var Ve=function(e){return window.history.pushState(0,0,(window.history.pathname||"")+"?"+e.toString().replace(/%2F/g,"/"))},Ye=function(e){var t=new URLSearchParams;Object.keys(e).forEach((function(a){return t.set(a,e[a])})),Ve(t)},Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.base,Object(n.useState)(Ke())),a=Object(l.a)(t,2),r=a[0],s=a[1],c=Object(n.useRef)(r);Object(n.useEffect)((function(){Xe();var e=function(){var e=Ke();c.current!==e&&s(c.current=e)},t=["popstate","pushState","replaceState"];return t.map((function(t){return window.addEventListener(t,e)})),e(),function(){return t.map((function(t){return window.removeEventListener(t,e)}))}}),[]);var i=Object(n.useCallback)((function(e,t){if(t)Ye(e);else{var a=new URLSearchParams(r.toString());Object.keys(e).forEach((function(t){return a.set(t,e[t])})),Ve(a)}}),[r]),o=Object(n.useCallback)((function(e){var t=new URLSearchParams(r.toString());t.delete(e),Ve(t)}),[r]);return[r,i,o]},$e=0,Xe=function(){if(!$e)return["pushState","replaceState"].map((function(e){var t=window.history[e];window.history[e]=function(){var a=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),a}})),$e=1},Ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search;return new URLSearchParams(e)};function Qe(e){var t=Ze(),a=Object(l.a)(t,3),n=a[0],s=a[2],c=n.get("q");return r.a.createElement("div",{className:"tags"},c&&r.a.createElement(he,{name:"Search:",color:"is-light",size:"is-size-7"}),c&&r.a.createElement(he,{name:c,color:"is-info",size:"is-size-7",onRemove:function(){s("q")}}))}var et="=",tt="title__in",at="||";var nt={page:0,items:[],loading:!0,total:0};function rt(e){var t,a=Ze(),s=Object(l.a)(a,2),c=s[0],i=s[1],u=L().PageSize,m=Object(n.useContext)(k),d=Object(se.a)(nt),p=Object(l.a)(d,2),f=p[0],h=p[1],v=f.items,g=f.loading,E=f.total,b=c.get("q");try{t=parseInt(c.get("page"))||0}catch(x){t=0}var y=void 0;b&&""!==b&&(y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt,a=void 0;return e.trim(),e.includes('"')&&(e=e.replace(/"(\w+) (\w+)"/,"$1".concat(at,"$2"))),(e=e.split(" ")).map((function(e){if(e.includes(at)&&(e=e.replace("||"," ")),!e.includes(et))return a?[a,e]:[t,e];var n=e.split(et),r=Object(l.a)(n,2),s=r[0],c=r[1];return a=s,[s,c]}))}(b)),Object(n.useEffect)((function(){m.state.loading||function(){var e,a;o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(h({loading:!0,total:m.context.length}),!b){n.next=8;break}return a=y.map((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(n))})).join("&"),n.next=5,o.a.awrap(m.client.search(m.path,a,!1,!1,t*u,u));case 5:e=n.sent,n.next=11;break;case 8:return n.next=10,o.a.awrap(m.client.getItems(m.path,t*u,u));case 10:e=n.sent;case 11:h({items:e.member,loading:!1,total:e.items_count});case 12:case"end":return n.stop()}}))}()}),[b,m.state.refresh,t]);return r.a.createElement(Fe,{items:v},r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column is-2 is-size-7"},r.a.createElement(Le,null)),r.a.createElement("div",{className:"column"},r.a.createElement(Qe,null)),r.a.createElement("div",{className:"column"},r.a.createElement(Je,{current:t,total:E,doPaginate:function(e){i({page:e})},pager:u}))),g&&r.a.createElement("div",{className:"progress-line"}),!g&&r.a.createElement("table",{className:"table is-fullwidth is-hoverable"},r.a.createElement("thead",{className:"is-size-7"},r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement(Ue,null)),r.a.createElement("th",null),r.a.createElement("th",{className:"has-text-info"},"type"),r.a.createElement("th",{className:"has-text-info"},"id/name"),r.a.createElement("th",{className:"has-text-info"},"created"),r.a.createElement("th",{className:"has-text-info"},"modified"),r.a.createElement("th",null,"\xa0"))),r.a.createElement("tbody",null,v&&v.map((function(e){return r.a.createElement(Ge,{item:e,setPath:m.setPath,key:e["@uid"],search:b})})),v&&0===v.length&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"6",className:"has-text-centered"},"Anything here!")))))}function st(e){var t=e.context,a=r.a.useContext(k).registry.getBehavior,n=[].concat(t.__behaviors__,t["@static_behaviors"]);return r.a.createElement(r.a.Fragment,null,n.map((function(e){return r.a.createElement("div",{className:"container",key:e},r.a.createElement("h3",{className:"title is-size-6 has-text-grey"},e),r.a.createElement(ge,{headers:["Field","Value"],className:"is-striped is-fullwidth is-size-7"},function(e){var n=a(e,ct);return r.a.createElement(n,t[e])}(e)),r.a.createElement("hr",null))})))}function ct(){return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},"Not Implemented"))}function lt(e){var t=r.a.useContext(k),a=(0,t.registry.getProperties)(t.context["@type"]);return a.Buttons?r.a.cloneElement(a.Buttons,{Ctx:t}):null}function it(e){var t=r.a.useContext(k),a=(0,t.registry.getProperties)(t.context["@type"]);return a.Panels?r.a.cloneElement(a.Panels,{Ctx:t}):null}var ot=["@id","@name","@uid","title"],ut=["title"];function mt(e){var t=r.a.useContext(k),a=t.hasPerm("guillotina.ModifyContent"),n=L(),s=new Re(t.context),c=n.properties_default||ot,l=n.properties_editable||ut;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("h2",{className:"title is-size-4 is-primary"},r.a.createElement($,{icon:s.icon,align:"is-left",className:"has-text-grey"})," ","\xa0",r.a.createElement("span",null,t.context.title||t.context["@name"]))),r.a.createElement("div",{className:"level-right"},r.a.createElement(lt,null))),r.a.createElement("hr",null),r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column"},r.a.createElement("table",{className:"table is-striped is-fullwidth is-size-7"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"is-2"},"Prop"),r.a.createElement("th",{className:"is-8"},"Value"))),r.a.createElement("tbody",null,c.map((function(e){return r.a.createElement("tr",{key:"prop"+e},r.a.createElement("td",null,e),r.a.createElement("td",null,l.includes(e)&&a?r.a.createElement(be,{field:e,value:t.context[e]}):r.a.createElement(xe,{value:t.context[e]})))})))),r.a.createElement(it,null),r.a.createElement(st,{context:t.context}))))}function dt(e){var t,a,n=e.roles,s=e.permissions,c=e.operations,i=e.refresh,u=de(),m=u.post,d=u.loading,p=Object(se.a)({role:void 0,permission:[],setting:void 0,error:void 0}),f=Object(l.a)(p,2),h=f[0],v=f[1];return r.a.createElement("div",{className:"container"},d,h.error&&r.a.createElement(W,null,"Invalid form data"),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Select a Role"),r.a.createElement(ee,{appendDefault:!0,options:n,onChange:function(e){return v({role:e.target.value})}})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Select permissions"),r.a.createElement(ee,{options:s,onChange:(t="permission",a=v,function(e){for(var n=[],r=0;r<e.target.selectedOptions.length;r++)n=n.concat([e.target.selectedOptions[r].value]);a(Object(ne.a)({},t,n))}),size:5,multiple:!0})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Operation"),r.a.createElement(ee,{appendDefault:!0,options:c,onChange:function(e){return v({setting:e.target.value})}})),r.a.createElement(z,{className:"is-primary is-small",loading:d,onClick:function(e){var t;return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.role&&h.setting&&0!==h.permission.length){e.next=4;break}return console.log(h),v({error:"Invalid form"}),e.abrupt("return");case 4:return t={roleperm:h.permission.map((function(e){return{role:h.role,permission:e,setting:h.setting}}))},e.next=7,o.a.awrap(m(t,"@sharing",!1));case 7:i(Math.random());case 8:case"end":return e.stop()}}))}},"Save"))}function pt(e){var t,a,n=e.groups,s=e.permissions,c=e.operations,i=e.refresh,u=de(),m=u.post,d=u.loading,p=Object(se.a)({principal:void 0,permission:[],setting:void 0,error:void 0}),f=Object(l.a)(p,2),h=f[0],v=f[1];return r.a.createElement("div",{className:"container"},d,h.error&&r.a.createElement(W,null,"Invalid form data"),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Select a Principal"),r.a.createElement(ee,{appendDefault:!0,options:n,onChange:function(e){return v({principal:e.target.value})}})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Select permissions"),r.a.createElement(ee,{options:s,onChange:(t="permission",a=v,function(e){for(var n=[],r=0;r<e.target.selectedOptions.length;r++)n=n.concat([e.target.selectedOptions[r].value]);a(Object(ne.a)({},t,n))}),size:5,multiple:!0})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Operation"),r.a.createElement(ee,{appendDefault:!0,options:c,onChange:function(e){return v({setting:e.target.value})}})),r.a.createElement(z,{className:"is-primary is-small",loading:d,onClick:function(e){var t;return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.principal&&h.setting&&0!==h.permission.length){e.next=3;break}return v({error:"Invalid form"}),e.abrupt("return");case 3:return t={prinperm:h.permission.map((function(e){return{principal:h.principal,permission:e,setting:h.setting}}))},e.next=6,o.a.awrap(m(t,"@sharing",!1));case 6:i(Math.random());case 7:case"end":return e.stop()}}))}},"Save"))}function ft(e){var t,a,n=e.groups,s=e.roles,c=e.operations,i=e.refresh,u=de(),m=u.post,d=u.loading,p=Object(se.a)({principal:void 0,roles:[],setting:void 0,error:void 0}),f=Object(l.a)(p,2),h=f[0],v=f[1];return r.a.createElement("div",{className:"container"},d,h.error&&r.a.createElement(W,null,"Invalid form data"),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Select a Principal"),r.a.createElement(ee,{appendDefault:!0,options:n,onChange:function(e){return v({principal:e.target.value})}})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Select a Role"),r.a.createElement(ee,{options:s,onChange:(t="roles",a=v,function(e){for(var n=[],r=0;r<e.target.selectedOptions.length;r++)n=n.concat([e.target.selectedOptions[r].value]);a(Object(ne.a)({},t,n))}),size:5,multiple:!0})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Operation"),r.a.createElement(ee,{appendDefault:!0,options:c,onChange:function(e){return v({setting:e.target.value})}})),r.a.createElement(z,{className:"is-primary is-small",loading:d,onClick:function(e){var t;return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.principal&&h.setting&&0!==h.roles.length){e.next=3;break}return v({error:"Invalid form"}),e.abrupt("return");case 3:return t={prinrole:h.roles.map((function(e){return{principal:h.principal,role:e,setting:h.setting}}))},e.next=6,o.a.awrap(m(t,"@sharing",!1));case 6:i(Math.random());case 7:case"end":return e.stop()}}))}},"Save"))}function ht(e){var t=de(),a=t.get,n=t.result,s=t.loading,c=r.a.useState(1),i=Object(l.a)(c,2),u=i[0],m=i[1];r.a.useEffect((function(){o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(a("@sharing"));case 2:case"end":return e.stop()}}))}),[u]);var d=new Pe(n);return r.a.createElement("div",{className:"columns"},!s&&r.a.createElement("div",{className:"column is-8 is-size-7 permissions"},r.a.createElement("h2",{className:"title is-size-5 has-text-grey-dark"},"Role Permissions"),r.a.createElement(ge,{headers:["Role","Premission","Setting"]},d.roles.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:"ff"+t},r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"has-text-link"},e)),Object.keys(d.getRole(e)).map((function(t,a){return r.a.createElement("tr",{key:"k"+a},r.a.createElement("td",null),r.a.createElement("td",null,t),r.a.createElement("td",null,d.getRole(e)[t]))})))})),0===d.roles.length&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},"No roles permissions defined"))),r.a.createElement("h2",{className:"title is-size-5 has-text-grey-dark"},"Principal Permissions"),r.a.createElement(ge,{headers:["Principal","Premission","Setting"]},d.principals.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:"f2"+t},r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"has-text-link"},e)),Object.keys(d.getPrincipals(e)).map((function(t,a){return r.a.createElement("tr",{key:"x"+a},r.a.createElement("td",null),r.a.createElement("td",null,t),r.a.createElement("td",null,d.getPrincipals(e)[t]))})))})),0===d.principals.length&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},"No principals permissions defined"))),r.a.createElement("h2",{className:"title is-size-5 has-text-grey-dark"},"Principal Roles"),r.a.createElement(ge,{headers:["Principal","Role","Setting"]},d.prinrole.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:e+t},r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"has-text-link"},e)),Object.keys(d.getPrinroles(e)).map((function(t,a){return r.a.createElement("tr",{key:"xx"+a},r.a.createElement("td",null),r.a.createElement("td",null,t),r.a.createElement("td",null,d.getPrinroles(e)[t]))})))})),0===d.prinrole.length&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},"No principals roles defined")))),r.a.createElement(bt,{refresh:m,reset:u}))}var vt={permissions:void 0,groups:void 0,roles:[],current:"",currentObj:void 0},gt=[{text:"Allow",value:"Allow"},{text:"Deny",value:"Deny"},{text:"AllowSingle",value:"AllowSingle"},{text:"Unset",value:"Unset"}],Et=[{text:"Choose..",value:""},{text:"Role Permissions",value:"roleperm"},{text:"Principal Permissions",value:"prinperm"},{text:"Principal Roles",value:"prinrole"}];function bt(e){var t=e.refresh,a=e.reset,n=r.a.useContext(k),s=Object(se.a)(vt),c=Object(l.a)(s,2),i=c[0],u=c[1];return r.a.useEffect((function(){!function(){var e,t,a,r;o.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.a.awrap(n.client.getAllPermissions(n.path));case 2:return s.t0=function(e){return{text:e,value:e}},e=s.sent.map(s.t0),s.next=6,o.a.awrap(n.client.getGroups(n.path));case 6:return t=s.sent,s.next=9,o.a.awrap(t.json());case 9:return s.t1=function(e){return{text:e.id,value:e.id}},a=s.sent.map(s.t1),s.next=13,o.a.awrap(n.client.getRoles(n.path));case 13:return t=s.sent,s.next=16,o.a.awrap(t.json());case 16:s.t2=function(e){return{text:e,value:e}},r=s.sent.map(s.t2),u({permissions:e,groups:a,roles:r});case 19:case"end":return s.stop()}}))}()}),[a]),r.a.createElement("div",{className:"column is-4 is-size-7"},r.a.createElement("h1",{className:"title is-size-5"},"Add Permissions"),r.a.createElement("p",null,"Select a type:"),r.a.createElement(ee,{options:Et,onChange:function(e){return u({current:e.target.value})}}),r.a.createElement("hr",null),i.current&&"roleperm"===i.current&&r.a.createElement(dt,Object.assign({},i,{operations:gt,refresh:t})),i.current&&"prinperm"===i.current&&r.a.createElement(pt,Object.assign({},i,{operations:gt,refresh:t})),i.current&&"prinrole"===i.current&&r.a.createElement(ft,Object.assign({},i,{operations:gt,refresh:t})))}var yt=function(e,t,a){var n={value:"",text:"Add ".concat(a)};return 0===e.length?[]:e[0]&&"string"===typeof e[0]?[n].concat(e.map((function(e){return{value:e,text:e}}))).filter((function(e){return!t.includes(e.value)})):[n].concat(e).filter((function(e){return!t.includes(e.value)}))};function xt(e){var t=e.items,a=e.available,n=e.title,s=e.noData,c=e.onChange,i=e.loading,o=r.a.useState(t),u=Object(l.a)(o,2),m=u[0],d=u[1];a=yt(a||[],m,n);var p=function(e){if(""!==e){var t=m.concat([e]);d(t),c(t)}};return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"title is-size-6"},n),i?r.a.createElement(fe,{style:{marginBottom:"1.5rem"}}):r.a.createElement("hr",null),r.a.createElement("ul",null,r.a.createElement("div",{className:"tags"},m.map((function(e){return r.a.createElement(he,{name:e,onRemove:function(){return function(e){var t=m.filter((function(t){return t!==e}));d(t),c(t)}(e)},key:e})}))),0===m.length&&r.a.createElement("li",{style:{marginBottom:"20px"}},s),a.length>1&&r.a.createElement("li",{className:"widget-list-add select is-small"},r.a.createElement(ee,{options:a,resetOnChange:!0,onChange:function(e){return p(e.target.value)}}))))}var Nt={types:void 0};function wt(e){var t=Object(se.a)(Nt),a=Object(l.a)(t,2),s=a[0],c=a[1],i=Object(n.useContext)(k),u=L();Object(n.useEffect)((function(){!function(){var e;o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(i.client.getTypes(i.path));case 2:e=t.sent,c({types:e.filter((function(e){return!u.DisabledTypes.includes(e)}))});case 4:case"end":return t.stop()}}))}()}),[i.path]);var m=function(e){i.doAction("addItem",{type:e}),c({isActive:!1})};return s.types&&1===s.types.length?r.a.createElement(z,{className:"is-small is-success",onClick:function(e){return m(s.types[0])}},"Add ",s.types[0]):s.types&&0===s.types.length?null:r.a.createElement(Te,{id:"dropdown-menu",isRight:!0,onChange:m,options:(s.types||[]).map((function(e){return{text:e,value:e}}))},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-plus"})))}function Ot(e){var t=e.AddButton,a=Object(u.a)(e,["AddButton"]),n=Ze(),s=Object(l.a)(n,2),c=s[0],i=s[1],o=r.a.useContext(k),m=r.a.useRef(null),d=c.get("q");return r.a.useEffect((function(){d&&""!==d||(m.current.value="")}),[d]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"level-item"},r.a.createElement("form",{action:"",className:"form",onSubmit:function(e){var t=e.target[0].value;i({q:t,tab:"Items",page:0}),e.preventDefault()}},r.a.createElement("div",{className:"field has-addons"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{ref:m,type:"text",className:"input is-size-7",placeholder:"Search..."})),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button has-background-grey-lighter is-size-7",type:"submit"},r.a.createElement($,{icon:"fas fa-search"})))))),o.hasPerm("guillotina.AddContent")&&r.a.createElement("div",{className:"level-item"},void 0!==t?r.a.createElement(t,null):r.a.createElement(wt,a)))}function jt(){var e=r.a.useContext(k),t=e.state.flash;return t.message?r.a.createElement(Ee,{isColor:t.type},t.message,r.a.createElement(ve,{onClick:function(){return e.clearFlash()}})):null}function kt(e){var t=Object(n.useContext)(k),a=Ze(),s=Object(l.a)(a,2)[1],c=t.path.replace(/\/$/,"").split("/"),i=Ct(c);return 1!==c.length&&r.a.createElement("nav",{className:"breadcrumb","aria-label":"breadcrumbs"},r.a.createElement("ul",null,c.map((function(e,t){return 0===t?r.a.createElement("li",{key:t},r.a.createElement("a",{onClick:function(){return s({path:i[t]},!0)}},r.a.createElement("span",{className:"icon"},r.a.createElement("i",{className:"fas fa-home"})))):r.a.createElement("li",{key:t},r.a.createElement("a",{onClick:function(){return s({path:i[t]},!0)}},e))}))))}var Ct=function(e){var t="",a=[];return e.map((function(e,n){return t+=0===n?"/":e+"/",a.push(t),e})),a};function St(){return r.a.createElement("div",{className:"box not-allowed"},r.a.createElement("h1",{className:"title has-text-danger",style:{fontSize:"4rem"}},r.a.createElement($,{icon:"fas fa-ban"})),r.a.createElement("h1",{className:"title has-text-grey-darker"},"Not Allowed"))}function At(){return r.a.createElement("div",{className:"box not-allowed"},r.a.createElement("h1",{className:"title has-text-grey",style:{fontSize:"4rem"}},r.a.createElement($,{icon:"fas fa-dizzy"})),r.a.createElement("h1",{className:"title has-text-grey-darker"},"404. Not Found"))}function Pt(e){var t=e.tabs,a=e.currentTab,s=e.rightToolbar,c=Object(u.a)(e,["tabs","currentTab","rightToolbar"]),i=Ze(),o=Object(l.a)(i,2),m=o[0],d=o[1];a=m.get("tab")?m.get("tab"):a||Object.keys(t)[0];var p=Object(n.useState)(a),f=Object(l.a)(p,2),h=f[0],v=f[1],g=t[h];r.a.useEffect((function(){Object.keys(t).includes(a)&&v(a)}),[a,t]);return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"tabs"},r.a.createElement("ul",null,Object.keys(t).map((function(e){return r.a.createElement("li",{className:"is-size-7 "+(e===h?"is-active":""),key:e},r.a.createElement("a",{onClick:function(){return function(e){d({tab:e})}(e)}},e))}))))),s&&r.a.createElement("div",{className:"level-right"},s)),r.a.createElement("div",{className:"container"},r.a.createElement(g,Object.assign({title:h},c))))}var Rt={Items:rt,Properties:mt,Behaviors:Ce,Permissions:ht},_t={Items:"guillotina.ViewContent",Properties:"guillotina.ViewContent",Behaviors:"guillotina.ModifyContent",Permissions:"guillotina.SeePermissions"};function zt(e){var t=r.a.useContext(k).filterTabs(Rt,_t);return r.a.createElement(Pt,Object.assign({tabs:t,currentTab:"Items",rightToolbar:r.a.createElement(Ot,e)},e))}var Tt={Properties:mt,Behaviors:Ce,Permissions:ht},It={Properties:"guillotina.ViewContent",Behaviors:"guillotina.ModifyContent",Permissions:"guillotina.SeePermissions"};function Dt(e){var t=r.a.useContext(k).filterTabs(Tt,It);return r.a.createElement(Pt,Object.assign({tabs:t,currentTab:"Properties"},e))}function Ft(e){var t=Object(n.useState)(!1),a=Object(l.a)(t,2),s=a[0],c=a[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut,Object.assign({isActive:s,setActive:c},e)),r.a.createElement("button",{className:"button is-warning is-pulled-right",onClick:function(){return c(!0)}},r.a.createElement("span",{className:"icon is-small"},r.a.createElement("i",{className:"fas fa-plus"})),r.a.createElement("span",null,"Create")))}function Ut(e){var t=e.isActive,a=e.setActive,s=Object(n.useContext)(k),c=Object(n.useState)(!1),i=Object(l.a)(c,2),u=i[0],m=i[1],d=Object(n.useState)(""),p=Object(l.a)(d,2),f=p[0],h=p[1],v=Object(n.useState)(void 0),g=Object(l.a)(v,2),E=g[0],b=g[1],y=Object(n.useContext)(k);return r.a.createElement(T,{isActive:t,setActive:a},r.a.createElement(X,{onSubmit:function(e){var t,n,r;return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),t={"@type":"Container",id:f},e.prev=2,e.next=5,o.a.awrap(s.client.createObject(s.path,t));case 5:return n=e.sent,e.next=8,o.a.awrap(n.json());case 8:r=e.sent,200===n.status?(s.refresh(),h(""),m(!1),a(!1),y.flash("Container created","primary")):(h(""),m(!1),b(r.message)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),b("Error-submitting-form"),m(!1);case 16:case"end":return e.stop()}}),null,null,[[2,12]])},title:"Add Container",error:E},r.a.createElement(Z,{required:!0,placeholder:"Container Name",onChange:function(e){h(e)},value:f,loading:u}),r.a.createElement(z,{loading:u},"Add Container")))}var Mt={Items:rt,Addons:function(e){var t=r.a.useContext(k),a=r.a.useState(!1),n=Object(l.a)(a,2),s=n[0],c=n[1],i=Object(Oe.a)((function(){var e,a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(t.client.getAddons(t.pathPrefix));case 2:return e=n.sent,n.next=5,o.a.awrap(e.json());case 5:return a=n.sent,n.abrupt("return",je(a));case 7:case"end":return n.stop()}}))}),[s]);return r.a.createElement(r.a.Fragment,null,i.loading?r.a.createElement("div",null,"loading"):i.error?r.a.createElement("p",null,"Error: ",i.error.message):r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column"},r.a.createElement("h2",{className:"title is-size-4 has-text-grey-dark"},"Available Addons"),r.a.createElement("hr",null),0===i.value.available.length&&r.a.createElement("p",null,"No Addon available in this container"),r.a.createElement("table",{className:"table is-12"},r.a.createElement("tbody",null,i.value.available.map((function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.title),r.a.createElement("td",null,r.a.createElement("button",{className:"button is-primary is-small",onClick:function(){return function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(e.client.installAddon(e.pathPrefix,t));case 2:e.flash("Addon ".concat(t," installed"),"success"),c(!s);case 4:case"end":return a.stop()}}))}(t,e.id)}},"Install")))}))))),r.a.createElement("div",{className:"column"},r.a.createElement("h2",{className:"title is-size-4 has-text-grey-dark"},"Installed Addons"),r.a.createElement("hr",null),0===i.value.installed.length&&r.a.createElement("p",null,"No Addon installed in this container"),r.a.createElement("table",{className:"table is-12"},r.a.createElement("tbody",null,i.value.installed.map((function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.title),r.a.createElement("td",null,r.a.createElement("button",{className:"button is-danger is-small",onClick:function(){return function(e,t){return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(e.client.removeAddon(e.pathPrefix,t));case 2:e.flash("Addon ".concat(t," removed"),"success"),c(!s);case 4:case"end":return a.stop()}}))}(t,e.id)}},"Remove")))})))))))},Registry:function(e){return r.a.createElement("div",{className:"container"},r.a.createElement("h2",{className:"title"},e.title),r.a.createElement("p",null,"Not implemented"))},Behaviors:Ce,Permissions:ht},Lt={Items:"guillotina.ViewContent",Addons:"guillotina.ManageAddons",Registry:"guillotina.ReadConfiguration",Behaviors:"guillotina.ModifyContent",Permissions:"guillotina.SeePermissions"};var Bt={type:"object",required:["username","password"],properties:{username:{type:"string",title:"Username"},email:{type:"string",title:"Email",widget:"email"},name:{type:"string",title:"Name"},password:{type:"string",title:"Password",widget:"password"},disabled:{type:"boolean",title:"Disabled"}}},qt=function(e){var t=e.isEdit,a=void 0!==t&&t,n=e.children,s=Object(u.a)(e,["isEdit","children"]),c=a?{}:{title:"Add User"};return r.a.createElement(Q,Object.assign({schema:Bt},s,c),n)},Wt=function(e){var t=r.a.useState(e),a=Object(l.a)(t,2),n=a[0],s=a[1];return[n,function(e){return function(t){s(Object(re.a)({},n,Object(ne.a)({},e,t)))}}]},Gt={Users:rt};function Ht(e){var t=r.a.useContext(k);return r.a.createElement("button",{className:"button is-primary",onClick:function(){return t.doAction("addItem",{type:"User"})},"aria-haspopup":"true","aria-controls":"dropdown-menu"},r.a.createElement($,{icon:"fas fa-user"}),r.a.createElement("span",null,"Add a User"))}var Jt=function(e){return e.status>=300};var Vt=function(e){return e.status>=300};function Yt(e){var t=e.onSubmit,a=e.actionName,s=e.title,c=Object(n.useState)(""),i=Object(l.a)(c,2),o=i[0],u=i[1],m=Object(n.useState)(""),d=Object(l.a)(m,2),p=d[0],f=d[1],h=Object(n.useState)(void 0),v=Object(l.a)(h,2),g=v[0],E=v[1];return r.a.createElement(X,{title:s,onSubmit:function(e){""!==o?t({title:o,id:p}):E("This field is required")}},r.a.createElement(Z,{id:"title",placeholder:"Title",required:!0,value:o,onChange:function(e){f(function(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var t="\xe0\xe1\xe4\xe2\xe8\xe9\xeb\xea\xec\xed\xef\xee\xf2\xf3\xf6\xf4\xf9\xfa\xfc\xfb\xf1\xe7\xb7/_,:;",a=0,n=t.length;a<n;a++)e=e.replace(new RegExp(t.charAt(a),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(a));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}(e)),u(e)},autofocus:!0,error:g}),r.a.createElement(Z,{id:"id",placeholder:"Id",value:p,onChange:f}),r.a.createElement("div",{className:"level level-right"},r.a.createElement("button",{type:"submit",className:"button is-success"},a||"Add")))}var Zt={Groups:rt};function $t(e){var t=r.a.useContext(k);return r.a.createElement("button",{className:"button is-primary",onClick:function(){return t.doAction("addItem",{type:"Group"})},"aria-haspopup":"true","aria-controls":"dropdown-menu"},r.a.createElement($,{icon:"fas fa-users"}),r.a.createElement("span",null,"Add a Group"))}var Xt=a(11),Kt=a(10),Qt=a(12),ea={color:"#F44336",fontSize:20,paddingBottom:20},ta={paths:{},views:{ErrorBoundary:function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(Xt.a)(this,(e=Object(Kt.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(Qt.a)(t,e),Object(d.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0,errorMsg:e.message,errorStack:t.componentStack})}},{key:"render",value:function(){var e=this.state,t=e.hasError,a=e.errorMsg,n=e.errorStack;return t?r.a.createElement("div",{className:"box main-panel"},r.a.createElement("div",{style:ea},"Something went wrong."),a&&r.a.createElement("p",null,r.a.createElement("b",null,a)),n&&r.a.createElement("p",null,n)):this.props.children}}]),t}(r.a.Component),Application:function(e){var t=e.state.context.databases;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Databases"),r.a.createElement("div",{className:"container"},r.a.createElement(He,{title:"Objects"}),t.map((function(e){return r.a.createElement(Be,{item:{id:e,path:"/".concat(e,"/")},key:e,icon:"fas fa-database"})}))))},Database:function(e){var t=e.state,a=(e.client,Object(u.a)(e,["state","client"]),Object(n.useContext)(k)),s=t.context.containers,c=t.path;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement(He,{title:"Containers",actions:r.a.createElement(Ft,null)}),r.a.createElement("table",{className:"table is-fullwidth is-hoverable"},r.a.createElement("tbody",null,s.map((function(e){return r.a.createElement(Be,{item:{id:e,path:"".concat(c).concat(e,"/")},key:e,icon:"fas fa-archive",setPath:a.setPath})}))))))},Container:function(e){var t=r.a.useContext(k).filterTabs(Mt,Lt);return r.a.createElement(Pt,Object.assign({tabs:t,currentTab:"Items",rightToolbar:r.a.createElement(Ot,e)},e))},UserManager:function(e){return r.a.createElement(Pt,Object.assign({tabs:Gt,currentTab:"Users",rightToolbar:r.a.createElement(Ht,null)},e))},User:function(e){var t=de(),a=t.Ctx,n=t.patch,s=t.loading,c=(t.isError,t.errorMessage,r.a.useState({roles:[],gorups:[]})),i=Object(l.a)(c,2),u=i[0],m=i[1],d={user_groups:[],user_roles:a.context.user_roles},p=Wt(d),f=Object(l.a)(p,2),h=f[0],v=f[1];return r.a.useEffect((function(){!function(){var e,t,n;o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.a.awrap(Promise.all([a.client.search(a.path,{type_name:"Group"},!0),a.client.getRoles(a.path)]));case 2:return e=r.sent,r.next=5,o.a.awrap(e[0]);case 5:return t=r.sent,r.next=8,o.a.awrap(e[1].json());case 8:n=r.sent,m({roles:n,groups:t.member.map((function(e){return{value:e.id,text:e["@name"]}}))});case 10:case"end":return r.stop()}}))}()}),[]),r.a.createElement("div",{className:"container"},r.a.createElement("h2",{className:"title is-size-4"},r.a.createElement($,{icon:"fas fa-user"}),"\xa0User"),r.a.createElement("hr",null),r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"container user-props"},r.a.createElement("p",null,r.a.createElement("label",null,"Username: ")," ",a.context.username," (",a.context.email,")"),r.a.createElement("p",null,r.a.createElement("label",null," Created: ")," ",Se(a.context.creation_date)),r.a.createElement("p",null,r.a.createElement("label",null," Updated: ")," ",Se(a.context.modification_date))),r.a.createElement("hr",null),r.a.createElement(qt,{actionName:"Save",onSubmit:function(e){return function(e){var t,r,s;return o.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return a.apply(e),c.next=3,o.a.awrap(n(e));case 3:t=c.sent,r=t.isError,s=t.errorMessage,r?a.flash("Update failed ".concat(s),"danger"):a.flash("Data updated","primary"),a.refresh();case 8:case"end":return c.stop()}}))}(e)},isEdit:!0,formData:a.context,exclude:["password"],remotes:h,submitButton:!1},r.a.createElement(z,{loading:s},"Update"))),r.a.createElement("div",{className:"column"},r.a.createElement(xt,{onChange:v("user_groups"),items:a.context.user_groups,title:"Groups",noData:"There is no groups for this user",available:u.groups}),r.a.createElement("hr",null),r.a.createElement(xt,{onChange:v("user_roles"),items:h.user_roles,title:"Roles",noData:"The user doesn't have any role",available:u.roles}))))},Group:function(e){var t=de(),a=t.Ctx,s=t.patch,c=Object(n.useState)([]),i=Object(l.a)(c,2),u=i[0],m=i[1],d=Object(n.useState)([]),p=Object(l.a)(d,2),f=p[0],h=p[1];return Object(n.useEffect)((function(){!function(){var e,t,n,r,s,c;o.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=a.client.getUsers(a.path),t=a.client.getRoles(a.path),i.next=4,o.a.awrap(Promise.all([e,t]));case 4:return n=i.sent,r=Object(l.a)(n,2),s=r[0],c=r[1],i.t0=m,i.next=11,o.a.awrap(c.json());case 11:return i.t1=function(e){return{text:e,value:e}},i.t2=i.sent.map(i.t1),(0,i.t0)(i.t2),i.t3=h,i.next=17,o.a.awrap(s.json());case 17:i.t4=function(e){return{text:e["@name"],value:e.id}},i.t5=i.sent.map(i.t4),(0,i.t3)(i.t5);case 20:case"end":return i.stop()}}))}()}),[]),r.a.createElement("div",{className:"container group-view"},r.a.createElement("h2",{className:"title is-size-4"},r.a.createElement($,{icon:"fas fa-users"}),r.a.createElement("span",null,"\xa0Group")),r.a.createElement("hr",null),r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column is-4"},r.a.createElement("label",{className:"label"},"Title: "),r.a.createElement(be,{field:"title",value:a.context.title})),r.a.createElement("div",{className:"column is-4 is-size-7"},r.a.createElement("h3",{className:"title is-size-6"},"Roles"),r.a.createElement("p",null,"Add a Role"),r.a.createElement(ee,{options:u.filter((function(e){return!a.context.user_roles.includes(e.value)})),appendDefault:!0,resetOnChange:!0,onChange:function(e){var t;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.target.value,n.next=3,o.a.awrap(s({user_roles:a.context.user_roles.concat(t)}));case 3:a.flash("Role ".concat(t," added to group"),"success"),a.refresh();case 5:case"end":return n.stop()}}))}}),r.a.createElement("hr",null),a.context.user_roles.map((function(e){return r.a.createElement("p",{className:"control"},r.a.createElement(he,{name:e,onRemove:function(t){return n=e,o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(s({user_roles:a.context.user_roles.filter((function(e){return e!==n}))}));case 2:a.flash("Role ".concat(n," removed from group"),"success"),a.refresh();case 4:case"end":return e.stop()}}));var n},size:"is-small"}))}))),r.a.createElement("div",{className:"column is-4 is-size-7"},r.a.createElement("h3",{className:"title is-size-6"},"Users"),r.a.createElement("p",null,"Add a User"),r.a.createElement(ee,{options:f.filter((function(e){return!a.context.users.includes(e.value)})),appendDefault:!0,onChange:function(e){var t;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.target.value,n.next=3,o.a.awrap(s({users:a.context.users.concat(t)}));case 3:a.flash("User ".concat(t," added to group!"),"success"),a.refresh();case 5:case"end":return n.stop()}}))}}),r.a.createElement("hr",null),a.context.users.map((function(e){return r.a.createElement("p",{className:"control"},r.a.createElement(he,{name:e,onRemove:function(t){return function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(s({users:a.context.users.filter((function(t){return t!==e}))}));case 2:a.flash("User ".concat(e," removed from group"),"success"),a.refresh();case 4:case"end":return t.stop()}}))}(e)},size:"is-small"}))})))))},GroupManager:function(e){return r.a.createElement(Pt,Object.assign({tabs:Zt,currentTab:"Groups",rightToolbar:r.a.createElement($t,null)},e))},Folder:zt,Item:Dt},actions:{addItem:function(e){var t=Object(n.useContext)(k),a=e.type,s=(0,t.registry.getForm)(a);return r.a.createElement(T,{isActive:!0,setActive:function(){t.cancelAction()}},r.a.createElement(s,{onSubmit:function(e,n){var r,s;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Object.assign({},{"@type":a},e.formData?e.formData:e),s=t.client,n.next=4,o.a.awrap(s.create(t.path,r));case 4:n.sent,t.flash("Content created!","success"),t.cancelAction(),t.refresh();case 8:case"end":return n.stop()}}))},onError:function(e){return console.log(e)},actionName:"Add "+a,title:"Add "+a,type:a}))},copyItems:function(e){var t=Object(n.useContext)(k),a=e.items,s=void 0===a?[]:a;return r.a.createElement(D,{title:"Copy to...",onConfirm:function(e){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(Promise.all(s.map((function(a){return t.client.post("".concat(t.path).concat(a["@name"],"/@duplicate"),{destination:e,new_id:a["@name"]})}))));case 2:if(a=n.sent,t.refresh(),t.cancelAction(),!a.every(Jt)){n.next=8;break}return t.flash("Oops! Items can't be copied to ".concat(e),"danger"),n.abrupt("return");case 8:if(!a.some(Jt)){n.next=11;break}return t.flash("Some items are not copied correctly!","warning"),n.abrupt("return");case 11:t.flash("Items copied!","success");case 12:case"end":return n.stop()}}))},onCancel:function(){return t.cancelAction()}})},moveItems:function(e){var t=Object(n.useContext)(k),a=e.items,s=void 0===a?[]:a;return r.a.createElement(D,{title:"Move to...",onConfirm:function(e){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(Promise.all(s.map((function(a){return t.client.post("".concat(t.path).concat(a["@name"],"/@move"),{destination:e,new_id:a["@name"]})}))));case 2:if(a=n.sent,t.refresh(),t.cancelAction(),!a.every(Vt)){n.next=8;break}return t.flash("Oops! Items can't be moved to ".concat(e),"danger"),n.abrupt("return");case 8:if(!a.some(Vt)){n.next=11;break}return t.flash("Some items are not moved correctly!","warning"),n.abrupt("return");case 11:t.flash("Items moved!","success");case 12:case"end":return n.stop()}}))},onCancel:function(){return t.cancelAction()}})},removeItems:function(e){var t=Object(n.useContext)(k),a=L(),s=r.a.useState(!1),c=Object(l.a)(s,2),i=c[0],u=c[1],m=e.items,d=void 0===m?[]:m,p=d[d.length-1]["@name"],f=d.map((function(e){return e["@name"]})).join(", ").replace(", ".concat(p)," and ".concat(p));return r.a.createElement(I,{loading:i,onCancel:function(){return t.cancelAction()},onConfirm:function(){var e,n,r;return o.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=[],u(!0),(n=d.map((function(a){var n,r;return o.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.a.awrap(t.client.delete(B(a)));case 2:if((n=s.sent).ok){s.next=8;break}return s.next=6,o.a.awrap(n.json());case 6:r=s.sent,e.push(r);case 8:case"end":return s.stop()}}))}))).push(b(a.DelayActions)),s.next=6,o.a.awrap(Promise.all(n));case 6:0===e.length?(t.flash("Items removed!","success"),t.refresh()):(r=e.map((function(e){return JSON.stringify(e)})).join("\n"),t.flash("Something went wrong!! ".concat(r),"danger")),u(!1),t.cancelAction();case 9:case"end":return s.stop()}}))},message:"Are you sure to remove: ".concat(f,"?")})}},forms:{UserManager:Yt,GroupManager:Yt,Folder:Yt,Item:Yt,User:qt,Group:Yt},behaviors:{"guillotina.behaviors.dublincore.IDublinCore":function(e){var t=r.a.useContext(k).hasPerm("guillotina.ModifyContent");return r.a.createElement(r.a.Fragment,null,Object.keys(e).map((function(a){return r.a.createElement("tr",{key:"dublin_"+a},r.a.createElement("td",{key:1},a),r.a.createElement("td",{key:2},we.editable.includes(a)&&t&&r.a.createElement(be,{field:a,value:e[a],Type:we.widgets[a]||Z,ns:"guillotina.behaviors.dublincore.IDublinCore"}),!we.editable.includes(a)&&r.a.createElement(xe,{value:e[a]})))})))},"guillotina.behaviors.attachment.IAttachment":function(e){var t,a,n=r.a.useContext(k),s=n.hasPerm("guillotina.ModifyContent");return r.a.createElement("tr",null,r.a.createElement("td",null,!e.file&&"undefined",e.file&&r.a.createElement(r.a.Fragment,null,e.file.filename," / ",e.file.content_type," (",e.file.size,")",r.a.createElement("br",null),r.a.createElement(z,{onClick:(t=e.file,a=e.file.content_type,function(e){var r,s,c,l,i,u;return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(n.path,"@download/file"),e.next=3,o.a.awrap(n.client.download(r));case 3:return s=e.sent,e.next=6,o.a.awrap(s.blob());case 6:c=e.sent,l=new Blob([c],{type:a}),i=window.URL.createObjectURL(l),(u=document.createElement("a")).href=i,u.setAttribute("download","".concat(t.filename)),document.body.appendChild(u),u.click(),u.parentNode.removeChild(u);case 15:case"end":return e.stop()}}))}),className:"is-small"},"Download"))),r.a.createElement("td",null,s&&r.a.createElement(te,{onChange:function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t="".concat(n.path,"@upload/file"),a.next=3,o.a.awrap(n.client.upload(t,e));case 3:if(200===a.sent.status){a.next=7;break}return n.flash("Failed to upload file","error"),a.abrupt("return");case 7:n.flash("file uploaded","success"),n.refresh();case 9:case"end":return a.stop()}}))}})))},"guillotina.behaviors.attachment.IMultiAttachment":function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(),u=Object(l.a)(i,2),m=u[0],d=u[1],p=Object(n.useState)(!1),f=Object(l.a)(p,2),h=f[0],v=f[1],g=Object(n.useState)(void 0),E=Object(l.a)(g,2),b=E[0],y=E[1],x=de().Ctx,N=function(e,t,a){return function(n){var r,s,c,l,i,u;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return r="".concat(x.path,"@download/files/").concat(e),n.next=3,o.a.awrap(x.client.download(r));case 3:return s=n.sent,n.next=6,o.a.awrap(s.blob());case 6:c=n.sent,l=new Blob([c],{type:t}),i=window.URL.createObjectURL(l),(u=document.createElement("a")).href=i,u.setAttribute("download","".concat(a)),document.body.appendChild(u),u.click(),u.parentNode.removeChild(u);case 15:case"end":return n.stop()}}))}};return r.a.createElement(r.a.Fragment,null,Object.keys(e.files).map((function(t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t),r.a.createElement("td",null,e.files[t].filename," / (",e.files[t].content_type,") \xa0",r.a.createElement(z,{className:"is-small",onClick:N(t,e.files[t].content_type,e.files[t].filename)},"Download")))})),0===Object.keys(e.files).length&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:2},"No files uploaded")),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:2},r.a.createElement("label",{className:"label"},"Upload a file"),r.a.createElement("form",{className:"columns"},r.a.createElement("div",{className:"column is-4"},r.a.createElement(Z,{placeholder:"Key",name:"field",className:"is-small",value:s,onChange:function(e){return c(e)}}),b&&r.a.createElement(W,null,b)),r.a.createElement("div",{className:"column is-2"},r.a.createElement(te,{onChange:function(e){return d(e)}}),m&&m.filename),r.a.createElement("div",{className:"column is-2"},r.a.createElement(z,{className:"is-primary is-small",loading:h,onClick:function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.preventDefault(),s||m){a.next=4;break}return y("Provide a file and a key name"),a.abrupt("return");case 4:return v(!0),y(void 0),t="".concat(x.path,"@upload/files/").concat(s),a.next=9,o.a.awrap(x.client.upload(t,m));case 9:if(200===a.sent.status){a.next=13;break}return y("Failed to upload file"),a.abrupt("return");case 13:c(""),d(void 0),v(!1),x.flash("".concat(s," uploaded!"),"success"),x.refresh();case 18:case"end":return a.stop()}}))},disabled:!s&&!m},"Upload"))))))}},schemas:{},properties:{}},aa=function(e,t,a){return ta[e]&&ta[e][t]||a},na=function(e,t,a){if(e)return ta.paths[t]?ta.paths[t]:ta.views[e["@type"]]?ta.views[e["@type"]]:a||ia(e)},ra=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yt;return ta.forms[e]||t},sa=function(e,t){return ta.actions[e]||t},ca=function(e,t){return ta.behaviors[e]||t},la=function(e){return ta.properties[e]||{}},ia=function(e){return e.is_folderish?zt:Dt};var oa={path:"",loading:!1,context:void 0,flash:{message:void 0,type:void 0},action:{action:void 0,params:void 0},permissions:void 0,errorStatus:void 0,registry:{},refresh:void 0};function ua(e,t){switch(t.type){case"SET_PATH":return Object(re.a)({},e,{path:t.payload,loading:!0});case"SET_CONTEXT":return Object(re.a)({},e,{},t.payload,{errorStatus:void 0,loading:!1});case"SET_ERROR":return Object(re.a)({},e,{errorStatus:t.payload,loading:!1});case"SET_FLASH":return Object(re.a)({},e,{},t.payload);case"CLEAR_FLASH":return Object(re.a)({},e,{flash:{message:void 0,type:void 0}});case"SET_ACTION":return Object(re.a)({},e,{action:t.payload});case"CLEAR_ACTION":return Object(re.a)({},e,{action:{action:void 0,params:void 0}});case"REFRESH":return Object(re.a)({},e,{refresh:Math.random(),loading:!0});case"APPLY":return Object(re.a)({},e,{context:Object(re.a)({},e.context,{},t.payload)});default:return e}}function ma(e){var t=e.auth,a=Object(u.a)(e,["auth"]),s=a.url||"http://localhost:8080",c=Object(n.useRef)();L(a.config||{});var i=function(e){var t=r.a.useRef();return e&&!t.current&&(console.log("registry initialized"),t.current=!0,Object.keys(e).map((function(t){return ta[t]=Object(re.a)({},ta[t],{},e[t])}))),{registry:ta,get:aa,getForm:ra,getComponent:na,getAction:sa,getBehavior:ca,getProperties:la}}(a.registry||{}),m=Ze(),d=Object(l.a)(m,2),f=d[0],h=d[1],v=f.get("path")||"/";v&&""!==v&&(oa.path=v);var g=Object(n.useReducer)(ua,oa),E=Object(l.a)(g,2),b=E[0],y=E[1];c.current||(c.current=a.client||function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new N(new p(e,t),a)}(s,t));var x=b.path,w=b.refresh,O=c.current;Object(n.useEffect)((function(){y({type:"SET_PATH",payload:v})}),[v]),Object(n.useEffect)((function(){!function(){var e,t,a,n;o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.a.awrap(O.getContext(x));case 2:if(401!==(e=r.sent).status){r.next=8;break}return y({type:"SET_ERROR",payload:"notallowed"}),r.abrupt("return");case 8:if(404!==e.status){r.next=11;break}return y({type:"SET_ERROR",payload:"notfound"}),r.abrupt("return");case 11:return r.next=13,o.a.awrap(e.json());case 13:return t=r.sent,r.next=16,o.a.awrap(O.canido(x,_e));case 16:return a=r.sent,r.next=19,o.a.awrap(a.json());case 19:n=r.sent,y({type:"SET_CONTEXT",payload:{context:t,permissions:n}});case 21:case"end":return r.stop()}}))}()}),[x,w,O]);var j=i.get("views","ErrorBoundary"),k={url:s,client:O,auth:t,state:b,dispatch:y,registry:i,setRouterParam:h},C=b.action,A=b.errorStatus,P=b.permissions,R=i.getComponent(b.context,x),_=C.action?i.getAction(C.action):null;return r.a.createElement(j,null,!A&&r.a.createElement(S,k,P&&r.a.createElement(r.a.Fragment,null,C.action&&r.a.createElement(_,C.params),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item"},r.a.createElement(kt,null)))),r.a.createElement(jt,null),R&&r.a.createElement(j,null,r.a.createElement("div",{className:"box main-panel"},b.loading&&r.a.createElement(fe,null),!b.loading&&r.a.createElement(R,{state:b}))))),"notallowed"===A&&r.a.createElement(St,null),"notfound"===A&&r.a.createElement(At,null))}function da(e){var t=e.children,a=e.onLogout,n=e.auth;return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",null,r.a.createElement("nav",{className:"navbar",role:"navigation","aria-label":"main navigation"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("a",{className:"navbar-item",href:"/"},r.a.createElement("img",{src:"/+manage/logo.svg",alt:"Guillotina logo",height:"80"})),r.a.createElement("a",{id:"burger",href:"/",role:"button",className:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarmenu"},r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}))),r.a.createElement("div",{id:"navbarmenu",className:"navbar-menu"},r.a.createElement("div",{className:"navbar-start"}),r.a.createElement("div",{className:"navbar-end"},r.a.createElement("div",{className:"navbar-item"},n.isLogged&&r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{className:"button is-size-7",onClick:function(e){n.logout(),a()}},r.a.createElement($,{icon:"fas fa-sign-out-alt",size:"is-size-7"}),r.a.createElement("span",null,"Logout")))))))),r.a.createElement("section",{className:"section main"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"column"},t))))}var pa=a(13),fa={failed_to_fetch:"Failed to fetch data: Backend not running?",invalid_credentials:"Failed! Invalid credentials"},ha=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(Xt.a)(this,Object(Kt.a)(t).call(this,e))).state={username:"",password:"",loading:void 0,schema:"",errors:void 0},a.ref=r.a.createRef(),a.doLogin=function(e){var t,n,r,s,c;return o.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e.preventDefault(),a.setState({loading:!0,errors:void 0}),t=a.state,n=t.username,r=t.password,""!==(s=t.schema)&&a.props.auth.setAccount(s),c=a.props.auth,l.next=7,o.a.awrap(c.login(n,r));case 7:if(l.sent){l.next=11;break}return a.setState({errors:c.errors,loading:!1}),l.abrupt("return");case 11:a.props.onLogin&&a.props.onLogin();case 12:case"end":return l.stop()}}))},e.schemas&&(a.state.schema=e.schemas[0]),a}return Object(Qt.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.ref.current.focus()}},{key:"render",value:function(){var e=this.state,t=e.password,a=e.username,n=e.errors,s=this.props.schemas;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"login__form",action:"",onSubmit:this.doLogin},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Username:"),r.a.createElement("input",{type:"text",className:"input",placeholder:"Username",onChange:Object(pa.a)(this,"username"),value:a,ref:this.ref})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Password:"),r.a.createElement("input",{type:"password",className:"input",onChange:Object(pa.a)(this,"password"),value:t})),s&&r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Schema:"),r.a.createElement("div",{className:"select"},r.a.createElement("select",{onChange:Object(pa.a)(this,"schema")},s.map((function(e){return r.a.createElement("option",{value:e,key:e},e)}))))),r.a.createElement("div",{className:"field"},r.a.createElement("button",{className:"button is-warning",type:"submit"},"Login")),r.a.createElement("div",{className:"field"},n&&r.a.createElement("p",{className:"has-text-danger"},fa[n]||"Generic error"))))}}]),t}(n.Component),va=a(18),ga=a.n(va),Ea=function(){function e(t){Object(m.a)(this,e),this.maxRetry=1,this.retryRefresh=0,this.events={},this.url=t,this.base_url=t,this.errors=void 0}return Object(d.a)(e,[{key:"getUrl",value:function(e){return"".concat(this.url).concat(e)}},{key:"setAccount",value:function(e){this.url=this.base_url+e}},{key:"login",value:function(e,t){var a,n,r;return o.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return a=this.getUrl("@login"),s.prev=1,s.next=4,o.a.awrap(fetch(a,{method:"post",body:JSON.stringify({username:e,password:t})}));case 4:if(200!==(n=s.sent).status){s.next=13;break}return s.next=8,o.a.awrap(n.json());case 8:return r=s.sent,this.storeAuth(r,e),s.abrupt("return",!0);case 13:this.errors="invalid_credentials";case 14:s.next=20;break;case 16:return s.prev=16,s.t0=s.catch(1),this.errors="failed_to_fetch",s.abrupt("return",!1);case 20:return localStorage.removeItem("auth"),localStorage.removeItem("auth_expires"),s.abrupt("return",!1);case 23:case"end":return s.stop()}}),null,this,[[1,16]])}},{key:"storeAuth",value:function(e){localStorage.setItem("auth",e.token),localStorage.setItem("auth_expires",e.exp)}},{key:"cleanAuth",value:function(){localStorage.removeItem("auth"),localStorage.removeItem("auth_expires")}},{key:"logout",value:function(){this.cleanAuth()}},{key:"refreshToken",value:function(){var e,t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("refresh!!!"),this.retryRefresh++,a.next=4,o.a.awrap(fetch(this.getUrl("@login-renew"),{headers:this.getHeaders(),method:"post"}));case 4:if(401!==(e=a.sent).status){a.next=9;break}return this.cleanAuth(),this.onLogout(),a.abrupt("return");case 9:return a.next=11,o.a.awrap(e.json());case 11:return t=a.sent,console.log("refresh data",t),this.storeAuth(t),console.log("token refreshed"),this.retryRefresh=0,a.abrupt("return",e.token);case 17:case"end":return a.stop()}}),null,this)}},{key:"willExpire",value:function(e){var t=(new Date).getTime();return 1e3*parseInt(e)<t+1e4}},{key:"isExpired",value:function(e){var t=(new Date).getTime();return!(1e3*parseInt(e)>t)}},{key:"_getToken",value:function(){return[localStorage.getItem("auth"),localStorage.getItem("auth_expires")]}},{key:"getToken",value:function(){var e=this._getToken();return Object(l.a)(e,1)[0]}},{key:"getHeaders",value:function(){var e=this,t=this._getToken(),a=Object(l.a)(t,2),n=a[0],r=a[1];return!!n&&(this.willExpire(r)&&this.retryRefresh<this.maxRetry&&o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(e.refreshToken());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}})),{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n})}},{key:"isLogged",get:function(){if("undefined"===typeof localStorage)return!1;var e=this._getToken(),t=Object(l.a)(e,2),a=t[0],n=t[1];return!(!a||!n)&&!this.isExpired(n)}},{key:"username",get:function(){if("undefined"===typeof localStorage)return!1;var e=this._getToken(),t=Object(l.a)(e,1)[0],a=ga()(t);return console.log(t),a.id}}]),e}(),ba=(a(28),"http://localhost:8080/"),ya=new Ea(ba="/");var xa=function(){var e=Object(n.useState)(ya.isLogged),t=Object(l.a)(e,2),a=t[0],s=t[1],c=function(){return s(!1)};return ya.onLogout=c,r.a.createElement(da,{auth:ya,onLogout:c},a&&r.a.createElement(ma,{auth:ya,url:ba}),!a&&r.a.createElement("div",{className:"columns is-centered"},r.a.createElement("div",{className:"columns is-half"},r.a.createElement(ha,{onLogin:function(){s(!0)},auth:ya}))))};c.a.render(r.a.createElement(xa,null),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.2bfc59fe.chunk.js.map